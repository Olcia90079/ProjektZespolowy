8b. Kryptografia


Człowiek od początku swoich dziejów porozumiewał się z innym człowiekiem. Z czasem wynalazł różne sposoby komunikowania się na odległość. Później, rodzące się społeczności, państwa i ich wodzowie potrzebowali sprawnych systemów łączności, by skutecznie władać swoimi, często rozległymi posiadłościami. Sprzeczne interesy różnych władców i dowódców powodowały, że zaczęli oni strzec wysyłanych przez siebie wiadomości przed przechwyceniem ich przez inne osoby. Tak narodziła się potrzeba szyfrowania, czyli utajniania treści przesyłanych wiadomości. Wielokrotnie w historii ludzkości szyfrowanie miało istotny wpływ na bieg wydarzeń. Matematycy Stanisław Leśniewski, Wacław Sierpiński i Stefan Mazurkiewicz złamali sowieckie szyfry w 1920 roku we Lwowie. Dzięki temu znane były zamiary Armii Czerwonej. Najbardziej spektakularnym jednak przykładem jest chyba historia rozpracowania niemieckiej maszyny szyfrującej Enigma, dzięki czemu – jak utrzymują historycy – II wojna światowa zakończyła się o 2-3 lata wcześniej. Dużą w tym rolę odegrali Polacy.


Polscy kryptolodzy

Polscy kryptolodzy – tym mianem określa się zespół kryptologów, kierowany przez Mariana Rejewskiego (pozostałymi członkami zespołu byli: Jerzy Różycki i Henryk Zygalski), który przed wybuchem II wojny światowej wsławił się opracowaniem metod i urządzeń służących do łamania szyfrów maszyny Enigma. Byli oni absolwentami Wydziału Matematyczno-Przyrodniczego Uniwersytu Poznańskiego. W 1929 roku uczestniczyli oni w kursie kryptologii, a od następnego roku pracowali w Biurze Szyfrów Sztabu Głównego Wojska Polskiego, początkowo w oddziale poznańskim, a od 1932 roku w Warszawie. W lipcu 1939 roku swoje materiały i urządzenia przekazali kryptologom z Francji i Wielkiej Brytanii. W czasie wojny prace nad deszyfracją Enigmy były kontynuowane przez Anglików w Bletchley Park koło Londynu. Polscy kryptolodzy zaś pracowali nad łamaniem szyfrów we Francji, a później również w Wielkiej Brytanii.


Enigma

W latach 20. XX wieku, niewiele lat po przegranej I wojnie światowej, Niemcy na nowo rozpoczęły budowę swojej potęgi militarnej. Jednym z fundamentalnych rozwiązań miała być bezpieczna komunikacja. Wysiłki te nasiliły się po dojściu Hitlera do władzy w 1933 roku. Pod koniec lat 20. XX wieku w wojsku niemieckim wprowadzono maszynę szyfrująco-deszyfrującą Enigma, początkowo stosowaną komercyjnie do celów cywilnych. Na długo przed wybuchem wojny, w państwach czujących zagrożenie niemieckim militaryzmem rozpoczęto działania mające na celu opracowanie sposobów łamania szyfrów maszyny Enigma. Największy sukces na tym polu odniósł zespół polskich kryptologów, którzy w grudniu 1932 roku złamali szyfr Enigmy. Miesiąc przed wybuchem wojny zaprezentowali oni i przekazali swoje osiągnięcia kryptologom z Francji i Wielkiej Brytanii.


Ogólny opis budowy i działania maszyny Enigma

Enigma była elektro-mechaniczną maszyną, w której układ okablowanych wirników i połączeń służył do zmiany podawanej (wprowadzanej) litery. Naciśnięcie klawisza z literą powodowało wysłanie sygnału elektrycznego, który przechodząc przez łącznicę wtyczkową, trzy lub cztery wirniki i z powrotem, wielokrotnie zamieniał naciśnietą literę na inną i na końcu zapalała się lampka z zaszyfrowaną literą. Każde naciśnięcie klawisza powodowało obrót wirników, więc te same litery były szyfrowane na różne sposoby. Początkowe ustawienie maszyny polegało na wyborze: trzech (lub czterech w marynarce wojennej) wirników spośród pięciu (lub ośmiu w marynarce), 6-11 połączeń na łącznicy wtykowej i początkowych pozycji wirników. Podstawowe elementy maszyny Enigma to: klawiatura złożona z 26 liter i służąca do wprowadzania tekstu jawnego, łącznica wtyczkowa w przedniej obudowie, służąca do zamiany liter, ruchome wirniki (rotory) szyfrujące i walec odwracający, lampki wskazujące zaszyfrowane litery. Impuls elektryczny, spowodowany naciśnięciem litery tekstu jawnego, przemierza: (a) tabelę połączeń modyfikowanych za pomocą łącznicy wtyczkowej i (b) ruchome wirniki (co najmniej trzy), (c) jest odbijany przez walec odwracający, i ponownie przechodzi przez (d) ruchome wirniki i (e) tabelę połączeń modyfikowanych, a na końcu (f) powoduje zapalenie się lampki z zaszyfrowaną literą (czyli z szyfrem wybranej na klawiaturze litery). Każde naciśnięcie klawisza powodowało obrót pierwszego wirnika o 1/26 część obwodu, co powodowało, że ta sama litera w tekście jawnym była szyfrowana innymi literami i nie pozwalało stosować przy deszyfracji metod częstościowych. Walec odwracający umożliwiał deszyfrację tekstu przy tych samych ustawieniach początkowych maszyny – był on tym elementem maszyn Enigma, który nieco ułatwiał deszyfrację. W początkowym okresie stosowania maszyn Enigma, szyfrant wykonywał kolejno następujące czynności: na podstawie obowiązujących na dany dzień ustaleń (opisane to było w księdze kodowej), ustawiał wirniki ruchome w odpowiedniej kolejności i zmieniał litery na łącznicy przez odpowiednie umieszczenie wtyczek w gniazdach. Następnie dla każdej depeszy wybierał 3 litery (tyle, ile wirników ruchomych) jako klucz i szyfrował je dwukrotnie. Otrzymane w ten sposób sześć liter umieszczał na początku zaszyfrowanego tekstu. Następnie przestawiał wirniki na wybrany dla danej depeszy klucz i szyfrował całą depeszę. Liczby: zamian liter (stosowano 6-11 połączeń wtyczkowych), ustawień wirników (6 dla 3 wirników), wyboru pozycji początkowej dla wirnika (26 3 = 17576) i ustawień walca odwracającego pozwalały generować ponad 22 miliony różnych podmian (podstawień) literowych, wśród których nie było żadnych dwóch jednakowych par liter tekstu jawnego i zaszyfrowanego. W czasie wojny rozwinięciem metod deszyfracji maszyny Enigma zajęli się na olbrzymią skalę Brytyjczycy – działania te prowadzono pod kryptonimem ULTRA – budując w tym celu specjalny ośrodek w Bletchley Park pod Londynem. Powstały tam m.in. zmodyfikowane bomby kryptologiczne – w okresie największego nasilenia prac pracowało ponad 200 takich maszyn – oraz komputer Colossus (1943), który faktycznie był pierwszym komputerem elektronicznym kiedykolwiek zbudowanym. W Bletchley Park przez cały okres wojny pracował m.in. Alan M.Turing, który miał olbrzymi wpływ zarówno na budowane tam maszyny matematyczne, jak i na kierunek prac kryptograficznych. Niestety, zgodnie z brytyjskim prawem o ochronie tajemnicy, o osiągnięciach Brytyjczyków w kryptografii w czasie II wojny światowej świat dowiedział się dopiero w połowie lat 70. XX wieku.

Bomba brytyjczyków

Brytyjczycy usprawnili i znacznie rozbudowali „polską bombę”. Przy jej budowie uczestniczył A. M. Turing. Zaczęto je budować od 1940 roku i w pewnym okresie w Bletchley Park pracowało ponad 200 bomb. Gdy w 1942 roku Niemcy dodali czwarty wirnik do maszyn Enigma i zaczęli wyposażać w nie okręty podwodne U--boty, brytyjskie Bomby nie były w stanie deszyfrować ich wiadomości. Po przystąpieniu do wojny w 1941 roku i by zapobiec swoim stratom na morzu, Amerykanie zaprojektowali Bombę, która była w stanie łamać szyfry czterowirnikowych maszyn Enigma. Pierwsze Bomby Amerykanów pojawiły się pod konie 1943 roku i w sumie zainstalowano ich ponad 120. Pod koniec wojny Amerykanie przejęli całkowicie od Brytyjczyków deszyfrowanie wiadomości kierowanych do i od U-botów.


Colossus

Elektroniczna lampowa (zawierała 1500 lamp) maszyna cyfrowa specjalnego przeznaczenia, sterowana programem przechowywanym w maszynie (częściowo programowalna), zbudowana w czasie II Wojny Światowej w Wielkiej Brytanii na potrzeby kryptologów skupionych w ośrodku kryptograficznym w Bletchley Park pod Londynem i pracujących dla Wydziału Komunikacji Ministerstwa Spraw Zagranicznych. W Bletchley Park zajmowano się deszyfracją depesz kodowanych za pomocą maszyn Enigma i maszyn Lorenz – Colossus był zaprojektowany do deszyfracji wiadomości kodowanych szyfrem maszyn Lorenz. Ze względu na tajemnicę państwową, pierwsze informacje dotyczące maszyn Colossus zostały oficjalnie ujawnione przez Rząd Brytyjski dopiero w 1975 roku, 30 lat po zakończeniu wojny. Z tych informacji wiadomo, że projekt maszyny opracował zespół po kierunkiem M. H. A. Newmana, a T. H. Flowers kierował zespołem, który zajmował się jej budową. Jak podano, A. M. Turing w tym czasie pracował w tym samym Wydziale, i jego wcześniejsza praca, w której przedstawił abstrakcyjny model komputera, miała istotny wpływ na rozwiązania projektowe w tej maszynie. Maszyna Colossus, w zawrotnym jak na tamte czasy tempie, czytała 5000 znaków na sekundę z dziurkowanej taśmy i wykonywała 100 operacji logicznych jednocześnie. Pierwszą maszynę Colossus testowano w grudniu 1943 roku i rozpoczęła ona pracę w lutym 1944 roku. Wyprodukowano 11 egzemplarzy tej maszyny w dwóch modelach (Mark I i Mark II). Większość z tych maszyn została rozmontowana po wojnie. W muzeum w Bletchley Park można oglądać replikę maszyny Colossus Mark II, zbudowaną w 2003 roku. Uważa się, że prace brytyjskich kryptografów w Bletchley Park – do końca wojny odczytano ponad 63 miliony znaków w zaszyfrowanych wiadomościach – przyśpieszyły zakończenie wojny o blisko dwa lata.